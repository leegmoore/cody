===== COPY THIS INTO FRESH CLAUDE CODE SESSION FOR PHASE 4.5 =====

ROLE: You are a TypeScript developer migrating tools and optimizing the script harness.

PROJECT: Codex TypeScript port - complete tool set + optimized script harness.

STRATEGY: Careful migration following comprehensive guide.

CURRENT PHASE: Phase 4.5 - Tool Migration & Script Harness Optimization

PHASE 4.4 STATUS: ‚úÖ COMPLETE (Script harness core with 401 tests)

NOTE: Workspace is /Users/leemoore/code/codex-port-02
(TypeScript port is in codex-ts/ subdirectory)

üö® CRITICAL - READ MIGRATION GUIDE FIRST:
- Read .migration-staging/MIGRATION_GUIDE.md (COMPLETE step-by-step instructions)
- Has: Dependencies, import conversion, Bun‚ÜíNode.js, type handling, test conversion
- Has: Code examples, common issues, solutions
- Has: Integration pattern

THEN: Read documentation
- Read PORT-PHASES/phase-4.5/README.md (overview)
- Read PORT-PHASES/phase-4.5/CHECKLIST.md (detailed tasks)
- Read PORT-PHASES/phase-4.5/STATUS.md (progress tracking)

FILES STAGED IN REPO (.migration-staging/tools-from-codex-port/):

Source files:
- applyPatch/ (applyPatch.ts, parser.ts, seekSequence.ts)
- readFile.ts
- listDir.ts
- grepFiles.ts
- types.ts (ToolResult interface reference)

Test files (COPY THESE):
- applyPatch.test.ts
- readFile.test.ts
- listDir.test.ts
- grepFiles.test.ts

DEPENDENCIES TO INSTALL:
npm install web-tree-sitter @vscode/tree-sitter-wasm

MIGRATION TASKS (IN ORDER):

Task 1: Tool Migration (Follow MIGRATION_GUIDE.md for each)
1. applyPatch (REPLACE - has full tree-sitter, ours is stubbed)
2. readFile (ADD - indentation-aware file reading)
3. listDir (ADD - recursive directory listing)
4. grepFiles (ADD - ripgrep content search)

Each tool needs:
- Copy source to codex-ts/src/tools/[tool-name]/
- Update imports (add .js, kebab-case file names)
- Convert Bun‚ÜíNode.js (if applicable)
- Copy tests, update test framework (bun:test ‚Üí vitest)
- Run tests, fix issues
- Verify 100% passing

Task 2: tools.spawn
- Detached tasks for phone-a-sme (10+ min operations)
- Add to tool-facade.ts

Task 3: Performance
- Worker pool, context reuse, caching

Task 4: Documentation
- 5 guides

WORKFLOW:
1. Read MIGRATION_GUIDE.md for specific tool
2. Follow steps exactly
3. Run: npm test -- [tool-name]
4. Fix any issues using guide's "Common Issues" section
5. Verify passing
6. Commit: git add -A && git commit -m "phase4.5: migrate [tool-name]" && git push
7. Update CHECKLIST.md
8. Move to next tool

BEFORE ENDING SESSION:
1. Update PORT-PHASES/phase-4.5/CHECKLIST.md (check off completed tasks)
2. Update PORT-PHASES/phase-4.5/STATUS.md (session log)
3. Update codex-ts/PORT_LOG_MASTER.md
4. git add -A && git commit -m "phase4.5: [summary of work]" && git push
5. Report: tools migrated, tests passing, issues encountered, what's next

START by reading MIGRATION_GUIDE.md, then migrate applyPatch first (most complex).

‚ö†Ô∏è DO NOT SKIP THE MIGRATION GUIDE - it has critical conversion info.
